ggplot(mapping = aes(x=room_type, y= mean))+
geom_bar(stat="identity", fill = "azure2", color = "black", size = 1)+
geom_errorbar(mapping = aes(ymin= mean, ymax=mean+sd), width = 0.3, size = 1)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())+
labs(title = "Price Distribution by Room Type (bars show mean)", x="Room Type", y="Price")+
geom_violin(data=dataout, mapping = aes(x=room_type, y= price), fill=NA)
dataout %>% filter(price<=quantile(price,0.85)) %>% group_by(neighbourhood_group) %>% summarise(mean=mean(price), sd = sd(price)) %>%
ggplot(mapping = aes(x=neighbourhood_group, y= mean))+
geom_bar(stat="identity", fill = "azure2", color = "black", size = 1)+
geom_errorbar(mapping = aes(ymin= mean, ymax=mean+sd), width = 0.3, size = 1)+
theme_bw()+
geom_violin(data=dataout, aes(x=neighbourhood_group, y = price), fill = NA)+
labs(title="Mean Price and Price Distribution by Neighborhood (bars show mean)")+xlab("")+ylab("Price")
ggplot(dataout, mapping = aes(x=price))+
geom_histogram(bins = 50, fill ="azure2", color = "black")+
theme_bw()+
labs(title = "Price Distrsibution", x="Price", y="Number of Listings")+
geom_density(data = dataout, mapping = aes(x=price))
ggplot(dataout, mapping = aes(x=price, y=..density..))+
geom_histogram(bins = 50, fill ="azure2", color = "black")+
theme_bw()+
labs(title = "Price Distrsibution", x="Price", y="Number of Listings")+
geom_density(data = dataout, mapping = aes(x=price))
dataout %>% filter(price<=quantile(price,0.85)) %>% group_by(neighbourhood_group) %>% summarise(mean=mean(price), sd = sd(price)) %>%
ggplot(mapping = aes(x=neighbourhood_group, y= mean))+
geom_bar(stat="identity", fill = "azure2", color = "black", size = 1)+
geom_errorbar(mapping = aes(ymin= mean, ymax=mean+sd), width = 0.3, size = 1)+
theme_bw()+
geom_violin(data=dataout, aes(x=neighbourhood_group, y = price), fill = NA)+
labs(title="Mean Price and Price Distribution by Neighborhood (bars show mean)")+xlab("")+ylab("Price")+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
ggplot(data = dataout, aes(x=room_type, y=..density.., color = as.factor(room_type)))+
geom_density()
ggplot(data = dataout, aes(x=room_type, y=..density.., fill = as.factor(room_type)))+
geom_density()
ggplot(data = dataout, aes(x=price, y=..density.., fill = as.factor(room_type)))+
geom_density()
ggplot(data = dataout, aes(x=price, y=..density.., fill = as.factor(room_type)))+
geom_density(alpha = 0.5)+
theme_bw()+
labs(title = "Price Distribution for Room Types",
x= "Price",
y= "Density",
fill = "Room Types")
ggplot(data = dataout, aes(x=price, y=..density.., fill = as.factor(room_type)))+
geom_density(alpha = 0.5, color=NA)+
theme_bw()+
labs(title = "Price Distribution for Room Types",
x= "Price",
y= "Density",
fill = "Room Types")
dataout %>% arrange(desc(calculated_host_listings_count)) %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% unique() %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% unique(incomparables = host_id) %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% group_by(host_id) %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% group_by(host_id) %>% unique() %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id) %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name) %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head()
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head() %>%
ggplot(mapping = aes(x=calculated_host_listings_count, y=host_name))+geom_bar()+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head() %>%
ggplot(mapping = aes(x=calculated_host_listings_count, y=host_name))+geom_bar(stat = "identity")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head() %>%
ggplot(mapping = aes(x=calculated_host_listings_count, y=reorder(host_name, -calculated_host_listings_count)))+geom_bar(stat = "identity")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head() %>%
ggplot(mapping = aes(x=calculated_host_listings_count, y=reorder(host_name, calculated_host_listings_count)))+geom_bar(stat = "identity")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head(5) %>%
ggplot(mapping = aes(x=calculated_host_listings_count,
y=reorder(host_name,calculated_host_listings_count)))+
geom_bar(stat = "identity", fill = "azure4")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
labs(title = "5 Hosts with Highest Listing Numbers",
x="Number of Listings", y="")
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head(5) %>%
ggplot(mapping = aes(x=calculated_host_listings_count,
y=reorder(host_name,calculated_host_listings_count)))+
geom_bar(stat = "identity", fill = "azure2")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
labs(title = "5 Hosts with Highest Listing Numbers",
x="Number of Listings", y="")
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head(5) %>%
ggplot(mapping = aes(x=calculated_host_listings_count,
y=reorder(host_name,calculated_host_listings_count)))+
geom_bar(stat = "identity", fill = "azure2", color="black")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
labs(title = "5 Hosts with Highest Listing Numbers",
x="Number of Listings", y="")
dataout %>% arrange(desc(calculated_host_listings_count)) %>% distinct(host_id, host_name, calculated_host_listings_count) %>% head(5) %>%
ggplot(mapping = aes(x=calculated_host_listings_count,
y=reorder(host_name,calculated_host_listings_count)))+
geom_bar(stat = "identity", fill = "azure2", color="black", size = 1)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
labs(title = "5 Hosts with Highest Listing Numbers",
x="Number of Listings", y="")
ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")
ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")
dataout %>% group_by(neighbourhood_group) %>% summarise(mean=mean(price), sd = sd(price)) %>%
ggplot(mapping = aes(x=neighbourhood_group, y= mean))+
geom_bar(stat="identity", fill = "azure2", color = "black", size = 1)+
geom_errorbar(mapping = aes(ymin= mean, ymax=mean+sd), width = 0.3, size = 1)+
theme_bw()+
geom_violin(data=dataout, aes(x=neighbourhood_group, y = price), fill = NA)+
labs(title="Mean Price and Price Distribution by Neighborhood (bars show mean)")+xlab("")+ylab("Price")+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
ggplot(data = dataout, aes(x=number_of_reviews, y=price))+
geom_point()
ggplot(data = dataout, aes(x=number_of_reviews, y=price))+
geom_point(alpha = 0.1)
ggplot(data = dataout, aes(x=number_of_reviews, y=price))+
geom_point(alpha = 0.1, position = "jitter")
ggplot(data = dataout, aes(x=number_of_reviews, y=price))+
geom_point(alpha = 0.1, position = "jitter")+geom_smooth()
ggplot(data = dataout, aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+geom_smooth()
ggplot(data = dataout, aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+geom_smooth()+
geom_density2d()
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot( aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+geom_smooth()+
geom_density2d()
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+
geom_density2d()
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+
geom_density2d_filled()
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+
geom_density2d()
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+
geom_density2d()+coord_trans(y="log")
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_point(alpha = 0.1, position = "jitter")+
geom_density2d_filled()+coord_trans(y="log")
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_density2d_filled()+coord_trans(y="log")
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_density2d_filled()+coord_trans(y="log10")
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_density2d_filled()+coord_trans(y="identity")
dataout %>% filter(number_of_reviews >= 10) %>%
ggplot(aes(y=number_of_reviews, x=price))+
geom_density2d_filled()+coord_trans(y="sqrt")
sum(dataout$number_of_reviews==0)
sum(dataout$number_of_reviews==1)
sum(dataout$number_of_reviews==2)
sum(dataout$number_of_reviews==3)
sum(dataout$number_of_reviews==4)
sum(dataout$number_of_reviews==5)
sum(dataout$number_of_reviews<=5)
sum(!dataout$number_of_reviews<=5)
dataout$review <- ifelse(dataout$number_of_reviews<=0, "Less Than 5 Reviews", "More Than 5 Reviews")
ggplot(aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")
dataout$review <- ifelse(dataout$number_of_reviews<=0, "Less Than 5 Reviews", "More Than 5 Reviews")
ggplot(aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")
dataout$review <- ifelse(dataout$number_of_reviews<=5, "Less Than 5 Reviews", "More Than 5 Reviews")
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")
dataout$review <- ifelse(dataout$number_of_reviews<=5, "Less Than 5 Reviews", "More Than 5 Reviews")
if(dataout$number_of_reviews==0) dataout$review <- "No Reviews"
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")
dataout$review <- ifelse(dataout$number_of_reviews<=5, "Less Than 5 Reviews", "More Than 5 Reviews")
data$review <- ifelse(dataout$number_of_reviews==0, "No Reviews",)
dataout$review <- ifelse(dataout$number_of_reviews<=5, "Less Than 5 Reviews", "More Than 5 Reviews")
data$review <- ifelse(dataout$number_of_reviews==0, "No Reviews", data$review)
dataout$review <- ifelse(dataout$number_of_reviews<=5, "Less Than 5 Reviews", "More Than 5 Reviews")
dataout$review <- ifelse(dataout$number_of_reviews==0, "No Reviews", dataout$review)
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot()+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot(fill = "azure2")+
labs(title = "Two dimensional density between number of reviews and price",
x="Price", y="Number of Reviews")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
ggarrange(bar1, bar2, ncol = 2)
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")
ggarrange(bar1, bar2, ncol = 2)
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, ncol = 2)
ggarrange(bar1, bar2, nrow = 2)
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(title = "",
x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2)
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(title = "Neighborhoods and Room Types",
x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2)
ggarrange(bar1, bar2, nrow = 2, common.legend = T)
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2, common.legend = T)
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+ggtitle("hello")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(x= "Neighborhood",
y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()+theme(axis.title.x = element_blank())
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()+theme(axis.text.x = element_blank())
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank())+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()+theme(axis. = element_blank())
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.x=element_blank())+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.x=element_blank())
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.x=element_blank())
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y=element_blank())+
ggtitle("Neighborhoods by Room Types")
bar1 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), color="black")+
theme_bw()+
labs(y= "Number of listings",
fill = "Room Types")+coord_flip()+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y=element_blank())
bar2 <- ggplot()+
stat_count(data=dataout, mapping = aes(x=neighbourhood_group, fill=room_type), position = "fill",
color="black")+
theme_bw()+
labs(y= "Portion of Listings",
fill = "Room Types")+coord_flip()+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
axis.title.y=element_blank())
ggarrange(bar1, bar2, nrow = 2, common.legend = T)+
ggtitle("Neighborhoods by Room Types")
dataout$review <- ifelse(dataout$number_of_reviews<=5, "Less Than 5 Reviews", "More Than 5 Reviews")
dataout$review <- ifelse(dataout$number_of_reviews==0, "No Reviews", dataout$review)
ggplot(data = dataout, aes(x=review, y=price))+
geom_boxplot(fill = "azure2")+
labs(title = "Two dimensional density between number of reviews and price",
y="Price", x="")+
theme_bw()+theme(panel.border = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank())
knit_with_parameters('C:/Users/arman/Desktop/Individual_Project/Arman_Azizyan_Individual_Project.Rmd', encoding = 'UTF-8')
