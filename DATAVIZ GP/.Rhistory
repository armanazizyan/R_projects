metro <- read.csv("metro.csv")
stops <- read.csv("stops.csv")
hotels <- read.csv("hotels.csv")
hotels <- na.omit(hotels)
restaurants <- read.csv("restaurants.csv")
restaurants <- na.omit(restaurants)
set.seed(1)
clusterize <- function(data, botlat, toplat, leftlong, rightlong, k) {
newdat <- data %>% filter(latitude <= toplat & latitude >= botlat,
longitude <= rightlong & longitude >= leftlong)
pos <- cbind(newdat$latitude, newdat$longitude)
cluster <- kmeans(pos, k)
return(cluster$centers)
}
trans <- rbind(metro,stops)
combined <- rbind(clothes, shoes, supermarket, metro, stops, artwork, attraction, monument, museum)
botlat <- min(df$lat)
toplat <- max(df$lat)
leftlong <- min(df$lng)
rightlong <- max(df$lng)
transclust <- clusterize(trans, botlat, toplat, leftlong, rightlong, 5)
comboclust <- clusterize(combined, botlat, toplat, leftlong, rightlong, 5)
superclust <- clusterize(supermarket, botlat, toplat, leftlong, rightlong, 5)
base <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+theme(legend.position = "none")
transplot <- qmplot(x=lng, y=lat, data=df, source="osm")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+
geom_point(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1]),
size = 7, shape = 13,color = "darkblue")+
geom_text(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1], label = "Transport"), vjust=-1)+
theme(legend.position = "none")
superplot <- qmplot(x=lng, y=lat, data=df, source="osm")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1]),
size = 7, shape = 13,color = "darkgreen")+
geom_text(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1], label = "Market"), vjust=-1)+
theme(legend.position = "none")
comboplot <- qmplot(x=lng, y=lat, data=df, source="osm")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1]),
size = 7, shape = 13,color = "darkred")+
geom_text(data = as.data.frame(comboclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1], label = "Combo"), vjust=-1)+
theme(legend.position = "none")
plot_grid(base, transplot, superplot, comboplot,
align = "v", nrow = 2, ncol = 2
)
artwork <- read.csv("artwork.csv")
attraction <- read.csv("attraction.csv")
monument <- read.csv("monument.csv")
museum <- read.csv("museum.csv")
###
clothes <- read.csv("clothes.csv")
shoes <- read.csv("shoes.csv")
supermarket <- read.csv("supermarket.csv")
metro <- read.csv("metro.csv")
stops <- read.csv("stops.csv")
hotels <- read.csv("hotels.csv")
hotels <- na.omit(hotels)
restaurants <- read.csv("restaurants.csv")
restaurants <- na.omit(restaurants)
set.seed(1)
clusterize <- function(data, botlat, toplat, leftlong, rightlong, k) {
newdat <- data %>% filter(latitude <= toplat & latitude >= botlat,
longitude <= rightlong & longitude >= leftlong)
pos <- cbind(newdat$latitude, newdat$longitude)
cluster <- kmeans(pos, k)
return(cluster$centers)
}
trans <- rbind(metro,stops)
combined <- rbind(clothes, shoes, supermarket, metro, stops, artwork, attraction, monument, museum)
botlat <- min(df$lat)
toplat <- max(df$lat)
leftlong <- min(df$lng)
rightlong <- max(df$lng)
transclust <- clusterize(trans, botlat, toplat, leftlong, rightlong, 5)
comboclust <- clusterize(combined, botlat, toplat, leftlong, rightlong, 5)
superclust <- clusterize(supermarket, botlat, toplat, leftlong, rightlong, 5)
base <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+theme(legend.position = "none")
transplot <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+
geom_point(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1]),
size = 7, shape = 13,color = "darkblue")+
geom_text(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1], label = "Transport"), vjust=-1)+
theme(legend.position = "none")
superplot <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1]),
size = 7, shape = 13,color = "darkgreen")+
geom_text(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1], label = "Market"), vjust=-1)+
theme(legend.position = "none")
comboplot <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1]),
size = 7, shape = 13,color = "darkred")+
geom_text(data = as.data.frame(comboclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1], label = "Combo"), vjust=-1)+
theme(legend.position = "none")
plot_grid(base, transplot, superplot, comboplot,
align = "v", nrow = 2, ncol = 2
)
artwork <- read.csv("artwork.csv")
attraction <- read.csv("attraction.csv")
monument <- read.csv("monument.csv")
museum <- read.csv("museum.csv")
###
clothes <- read.csv("clothes.csv")
shoes <- read.csv("shoes.csv")
supermarket <- read.csv("supermarket.csv")
metro <- read.csv("metro.csv")
stops <- read.csv("stops.csv")
hotels <- read.csv("hotels.csv")
hotels <- na.omit(hotels)
restaurants <- read.csv("restaurants.csv")
restaurants <- na.omit(restaurants)
set.seed(1)
clusterize <- function(data, botlat, toplat, leftlong, rightlong, k) {
newdat <- data %>% filter(latitude <= toplat & latitude >= botlat,
longitude <= rightlong & longitude >= leftlong)
pos <- cbind(newdat$latitude, newdat$longitude)
cluster <- kmeans(pos, k)
return(cluster$centers)
}
trans <- rbind(metro,stops)
combined <- rbind(clothes, shoes, supermarket, metro, stops, artwork, attraction, monument, museum)
botlat <- min(df$lat)
toplat <- max(df$lat)
leftlong <- min(df$lng)
rightlong <- max(df$lng)
transclust <- clusterize(trans, botlat, toplat, leftlong, rightlong, 5)
comboclust <- clusterize(combined, botlat, toplat, leftlong, rightlong, 5)
superclust <- clusterize(supermarket, botlat, toplat, leftlong, rightlong, 5)
base <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+theme(legend.position = "none")
transplot <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+
geom_point(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1]),
size = 7, shape = 13,color = "darkblue")+
geom_text(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1], label = "Transport"), vjust=-1)+
theme(legend.position = "none")
superplot <- qmplot(x=lng, y=lat, data=df, source="osm", alpha = 0.5)+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1]),
size = 7, shape = 13,color = "darkgreen")+
geom_text(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1], label = "Market"), vjust=-1)+
theme(legend.position = "none")
comboplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom="blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1]),
size = 7, shape = 13,color = "darkred")+
geom_text(data = as.data.frame(comboclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1], label = "Combo"), vjust=-1)+
theme(legend.position = "none")
plot_grid(base, transplot, superplot, comboplot,
align = "v", nrow = 2, ncol = 2
)
artwork <- read.csv("artwork.csv")
attraction <- read.csv("attraction.csv")
monument <- read.csv("monument.csv")
museum <- read.csv("museum.csv")
###
clothes <- read.csv("clothes.csv")
shoes <- read.csv("shoes.csv")
supermarket <- read.csv("supermarket.csv")
metro <- read.csv("metro.csv")
stops <- read.csv("stops.csv")
hotels <- read.csv("hotels.csv")
hotels <- na.omit(hotels)
restaurants <- read.csv("restaurants.csv")
restaurants <- na.omit(restaurants)
set.seed(1)
clusterize <- function(data, botlat, toplat, leftlong, rightlong, k) {
newdat <- data %>% filter(latitude <= toplat & latitude >= botlat,
longitude <= rightlong & longitude >= leftlong)
pos <- cbind(newdat$latitude, newdat$longitude)
cluster <- kmeans(pos, k)
return(cluster$centers)
}
trans <- rbind(metro,stops)
combined <- rbind(clothes, shoes, supermarket, metro, stops, artwork, attraction, monument, museum)
botlat <- min(df$lat)
toplat <- max(df$lat)
leftlong <- min(df$lng)
rightlong <- max(df$lng)
transclust <- clusterize(trans, botlat, toplat, leftlong, rightlong, 5)
comboclust <- clusterize(combined, botlat, toplat, leftlong, rightlong, 5)
superclust <- clusterize(supermarket, botlat, toplat, leftlong, rightlong, 5)
base <- qmplot(x=lng, y=lat, data=df, source="osm", geom = "blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+theme(legend.position = "none")
transplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom = "blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+
geom_point(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1]),
size = 7, shape = 13,color = "darkblue")+
geom_text(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1], label = "Transport"), vjust=-1)+
theme(legend.position = "none")
superplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom = "blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1]),
size = 7, shape = 13,color = "darkgreen")+
geom_text(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1], label = "Market"), vjust=-1)+
theme(legend.position = "none")
comboplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom="blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1]),
size = 7, shape = 13,color = "darkred")+
geom_text(data = as.data.frame(comboclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1], label = "Combo"), vjust=-1)+
theme(legend.position = "none")
plot_grid(base, transplot, superplot, comboplot,
align = "v", nrow = 2, ncol = 2
)
plot_grid(base, transplot, superplot, comboplot,
align = "v", nrow = 2, ncol = 2, labels = c("Only Hotels", "Public Transport", "Supermarkets", "All Combined")
)
knitr::opts_chunk$set(error=T, warning=F, message=F, echo=F)
library(ggplot2)
library(dplyr)
library(readr)
library(ggmap)
library(cowplot)
library(reshape2)
library(ggcorrplot)
library(viridis)
library(class)
library(stats)
hotels <- read_csv("TripAdvisorHotelClean.csv")
hotels <- hotels %>% arrange(desc(`Stars out of 5`)) %>% filter(`Stars out of 5` > 0 & lat != max(lat) & lng != max(lng))
restaurants <- read_csv("TripAdvisorRestaurantClean.csv")
df <- hotels
df <- na.omit(df)
df <- df %>% filter(lng<=44.53 & lng >=44.495, lat<=40.19 & lat>=40.17)
longlat <- cbind(df$lng, df$lat)
clusters <- kmeans(longlat, centers = 5)
yerevan <- c(min(hotels$lng), min(hotels$lat), max(hotels$lng), max(hotels$lat))
yvn <- get_map(location = yerevan, source="osm", zoom = 13)
yerevan_center <- c(44.49, 40.16, 44.535, 40.195)
yvn_center <- get_map(location = yerevan_center, source="osm")
map_zoomedOut <- ggmap(yvn) +
geom_point(data = hotels, aes(x = lng, y = lat, color = as.factor(`Stars out of 5`)), size = 3, alpha = 0.6) +
scale_colour_brewer(palette = 'Set1') +
ylab('') + xlab('') +
labs(color = "Stars") +
theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
map_zoomedOut
map_zoomedIn <- ggmap(yvn_center) +
geom_point(data = hotels, aes(x = lng, y = lat, color = as.factor(`Stars out of 5`)), size = 3.25, alpha = 0.8) +
scale_colour_brewer(palette = "Set1") +
ylab('') + xlab('') +
labs(color = "Stars") +
theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
map_zoomedIn
price_grouped1 <- hotels %>%
mutate(group = case_when(
between(Price, 0, 15000) ~ "Low",
between(Price, 15000, 40000) ~ "Medium",
between(Price, 40000, 98000) ~ "High",
TRUE ~ NA_character_
))
ggmap(yvn) +
geom_point(data = na.omit(price_grouped1), aes(x = lng, y = lat, color = factor(group, levels = c("High", "Medium", "Low"))), size = 3, alpha = 0.6) +
scale_color_brewer(palette = 'Set1') +
labs(color = "Price") +
ggtitle('Hotels Grouped by Price') + ylab('') + xlab('') +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank()) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
ggmap(yvn_center) +
geom_point(data = na.omit(price_grouped1), aes(x = lng, y = lat, color = factor(group, levels = c("High", "Medium", "Low"))), size = 3.5, alpha = 0.6) +
scale_colour_brewer(palette = "Set1") +
ylab('') + xlab('') + labs(color = "Price") +
theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
# STARS VS PRICE CORRELATION PLOTS
starsVSprice <- ggplot(hotels, aes(x = as.factor(`Stars out of 5`), y = `Price`, color = as.factor(`Stars out of 5`))) +
geom_jitter() +
scale_colour_brewer(palette = "Set1") +
ggtitle('Distribution of Hotels Grouped by Stars') +
theme_bw() +
theme(legend.position = 'None') + xlab('Stars out of 5')
bar_plot <- na.omit(hotels) %>%
group_by(`Stars out of 5`) %>%
summarise(mean = mean(Price),
n = n(),
sd = sd(Price)) %>%
mutate(se = sd/sqrt(n)) %>%
ggplot(aes(x = `Stars out of 5`, y = mean, fill = as.factor(`Stars out of 5`))) +
geom_bar(stat = "identity", alpha = 0.8) +
geom_errorbar(aes(x = `Stars out of 5`, ymin = mean - se, ymax = mean + se), width = 0.5, size = 1) +
theme_bw() +
theme(legend.position = "none") +
scale_fill_brewer(palette = "Set1") +
labs(x = "Stars out of 5", y = "Average Price") +
ggtitle('Average Prices for Different Hotel Stars')
plot_grid(
starsVSprice, bar_plot,
align = "v", nrow = 2
)
Q1 <- quantile(hotels$Price, probs=c(.25, .75), na.rm = TRUE)
Q2 <- quantile(hotels$`Nearby Resaurants`, probs=c(.25, .75), na.rm = TRUE)
Q3 <- quantile(hotels$`Nearby Attractions`, probs=c(.25, .75), na.rm = TRUE)
iqr1 <- IQR(hotels$Price, na.rm = TRUE)
iqr2 <- IQR(hotels$`Nearby Resaurants`, na.rm = TRUE)
iqr3 <- IQR(hotels$`Nearby Attractions`, na.rm = TRUE)
eliminated<- subset(hotels, hotels$Price > (Q1[1] - 1.5*iqr1) & hotels$Price < (Q1[2]+1.5*iqr1) &
hotels$`Nearby Resaurants` > (Q2[1] - 1.5*iqr2) & hotels$`Nearby Resaurants` < (Q2[2]+1.5*iqr2) &
hotels$`Nearby Attractions` > (Q3[1] - 1.5*iqr3) & hotels$`Nearby Attractions` < (Q3[2]+1.5*iqr3))
priceVSrestaurants <- eliminated %>% filter(`Nearby Resaurants` > 0) %>%
ggplot(aes(x = `Price`, y = `Nearby Resaurants`)) + geom_point(alpha = 0.6) + theme_bw() + geom_smooth(method = 'lm')
priceVSattract <- eliminated %>% filter(`Nearby Attractions` > 0) %>%
ggplot(aes(x = `Price`, y = `Nearby Attractions`)) + geom_point(alpha = 0.6) + theme_bw() + geom_smooth(method = 'lm')
attractVSrest <- ggplot(eliminated, aes(x = `Nearby Attractions`, y = `Nearby Resaurants`)) + geom_point(alpha = 0.6) + theme_bw() + geom_smooth(method = 'lm')
ratingcountVSattract <- ggplot(eliminated[eliminated$`Rating Count`!=0,], aes(x=`Price`, y = `Rating Count`)) +
geom_point(alpha = 0.6) + theme_bw() + geom_smooth(method = "lm")
plot_grid(
priceVSrestaurants, priceVSattract, attractVSrest, ratingcountVSattract,
align = "v", nrow = 2
)
heatmap_df <- hotels
heatmap_df <- na.omit(heatmap_df)
heatmap_df = subset(heatmap_df, select = -c(`Hotel Names`, `lat`, `lng`))
cormat <- round(cor(heatmap_df),2)
ggcorrplot(cormat,
hc.order = TRUE,
type = "lower",
outline.color = "white",
lab = TRUE)
restaurants <- restaurants %>% arrange(desc(`Rating`)) %>% filter(`Rating` > 0 & Longitude != min(Longitude))
restaurants_filtered <- restaurants
restaurants_filtered$Rating[restaurants_filtered$Rating == 2.5] <- 2
restaurants_filtered$Rating[restaurants_filtered$Rating == 3.5] <- 3
restaurants_filtered$Rating[restaurants_filtered$Rating == 4.5] <- 4
yerevan2 <- c(min(restaurants_filtered$Longitude), min(restaurants_filtered$Latitude), max(restaurants_filtered$Longitude), max(restaurants_filtered$Latitude))
yvn2 <- get_map(location = yerevan2, source="osm", zoom = 13)
map_zoomedOut2 <- ggmap(yvn2) +
geom_point(data = restaurants_filtered, aes(x = Longitude, y = Latitude, color = as.factor(Rating)), size = 2, alpha = 0.9) +
scale_colour_brewer(palette = "Set1") +
ylab('') + xlab('') +
labs(color = "Rating") +
theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
map_zoomedOut2
map_zoomedIn2 <- ggmap(yvn_center) +
geom_point(data = restaurants_filtered, aes(x = Longitude, y = Latitude, color = as.factor(Rating)), size = 3.25, alpha = 0.7) +
scale_colour_brewer(palette = "Set1") +
ylab('') + xlab('') +
labs(color = "Rating") + theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
map_zoomedIn2
yerevan_center2 <- c(44.505, 40.17, 44.526, 40.19)
yvn_center2 <- get_map(location = yerevan_center2, source="osm")
# RESTAURANTS AND HOTELS TOGETHER
ggmap(yvn_center2) +
geom_point(data = restaurants, aes(x = Longitude, y = Latitude), size = 3, alpha = 0.6) +
geom_point(data = hotels, aes(x = lng, y = lat), color = "red", size = 3.25, alpha = 0.7) +
scale_colour_brewer(palette = "Set1") +
ylab('') + xlab('') +
labs(color = "Rating") + theme_bw() +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
artwork <- read.csv("artwork.csv")
attraction <- read.csv("attraction.csv")
monument <- read.csv("monument.csv")
museum <- read.csv("museum.csv")
###
clothes <- read.csv("clothes.csv")
shoes <- read.csv("shoes.csv")
supermarket <- read.csv("supermarket.csv")
metro <- read.csv("metro.csv")
stops <- read.csv("stops.csv")
hotels <- read.csv("hotels.csv")
hotels <- na.omit(hotels)
restaurants <- read.csv("restaurants.csv")
restaurants <- na.omit(restaurants)
set.seed(1)
clusterize <- function(data, botlat, toplat, leftlong, rightlong, k) {
newdat <- data %>% filter(latitude <= toplat & latitude >= botlat,
longitude <= rightlong & longitude >= leftlong)
pos <- cbind(newdat$latitude, newdat$longitude)
cluster <- kmeans(pos, k)
return(cluster$centers)
}
trans <- rbind(metro,stops)
combined <- rbind(clothes, shoes, supermarket, metro, stops, artwork, attraction, monument, museum)
botlat <- min(df$lat)
toplat <- max(df$lat)
leftlong <- min(df$lng)
rightlong <- max(df$lng)
transclust <- clusterize(trans, botlat, toplat, leftlong, rightlong, 5)
comboclust <- clusterize(combined, botlat, toplat, leftlong, rightlong, 5)
superclust <- clusterize(supermarket, botlat, toplat, leftlong, rightlong, 5)
base <- qmplot(x=lng, y=lat, data=df, source="osm", geom = "blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+theme(legend.position = "none")
transplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom = "blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel"), vjust=-1)+
geom_point(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1]),
size = 7, shape = 13,color = "darkblue")+
geom_text(data = as.data.frame(transclust),
mapping = aes(x=transclust[,2],
y=transclust[,1], label = "Transport"), vjust=-1)+
theme(legend.position = "none")
superplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom = "blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1]),
size = 7, shape = 13,color = "darkgreen")+
geom_text(data = as.data.frame(superclust),
mapping = aes(x=superclust[,2],
y=superclust[,1], label = "Market"), vjust=-1)+
theme(legend.position = "none")
comboplot <- qmplot(x=lng, y=lat, data=df, source="osm", geom="blank")+
geom_point(mapping=aes(color=as.factor(clusters$cluster)), size = 4, alpha = 0.5)+
geom_point(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2]), shape = 7, size = 7)+
geom_text(data = as.data.frame(clusters$centers), mapping=aes(x=clusters$centers[,1], y=clusters$centers[,2], label = "Hotel", size = 5), vjust=-1)+
geom_point(data = as.data.frame(superclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1]),
size = 7, shape = 13,color = "darkred")+
geom_text(data = as.data.frame(comboclust),
mapping = aes(x=comboclust[,2],
y=comboclust[,1], label = "Combo"), vjust=-1)+
theme(legend.position = "none")
plot_grid(base, transplot, superplot, comboplot,
align = "v", nrow = 2, ncol = 2, labels = c("Only Hotels", "Public Transport", "Supermarkets", "All Combined")
)
shiny::runApp()
